{{ $state := .Params.state_abbreviation | lower }}
{{ $currentLang := .Site.Language.LanguageName }}
<div class="translations grid-col-5">
  <label for="language-switcher" class="usa-label usa-label--language">{{ .Site.Params.select_language }}</label>
  <select class="usa-select usa-select--language" name="language-switcher" id="language-switcher" onchange="window.location=this.value;">
    {{ range $.Site.Home.AllTranslations }}
    <option value="{{ if ($.IsHome) }}
        {{ .RelPermalink }}
      {{ else }}
        {{ .RelPermalink }}{{ .Site.Params.register_path }}/{{ $state }}
      {{ end }}"
      {{ if eq $currentLang .Language.LanguageName }}
        selected="selected"
      {{ end }}
    >{{ if not (eq .Site.Params.english_languageName "") }}
      {{ .Site.Params.english_languageName }} ({{ .Language.LanguageName }})
      {{ else }}
      {{ .Language.LanguageName }}
      {{ end }}
    </option>
    {{ end }}
  </select>
</div>
